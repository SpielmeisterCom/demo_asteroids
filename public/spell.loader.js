(function(e,t){function n(){}function r(e,t){if(e){"object"==typeof e&&(e=[].slice.call(e));for(var n=0,r=e.length;n<r;n++)t.call(e,e[n],n)}}function i(e,n){var r=Object.prototype.toString.call(n).slice(8,-1);return n!==t&&null!==n&&r===e}function s(e){return i("Function",e)}function o(e){e=e||n,e._done||(e(),e._done=1)}function u(e){var t={};if("object"==typeof e)for(var n in e)e[n]&&(t={name:n,url:e[n]});else t=e.split("/"),t=t[t.length-1],n=t.indexOf("?"),t={name:-1!==n?t.substring(0,n):t,url:e};return(e=g[t.name])&&e.url===t.url?e:g[t.name]=t}function a(e){var e=e||g,t;for(t in e)if(e.hasOwnProperty(t)&&e[t].state!==N)return!1;return!0}function f(e,t){t=t||n,e.state===N?t():e.state===T?S.ready(e.name,t):e.state===x?e.onpreload.push(function(){f(e,t)}):(e.state=T,l(e,function(){e.state=N,t(),r(m[e.name],function(e){o(e)}),w&&a()&&r(m.ALL,function(e){o(e)})}))}function l(t,r){var r=r||n,i;/\.css[^\.]*$/.test(t.url)?(i=p.createElement("link"),i.type="text/"+(t.type||"css"),i.rel="stylesheet",i.href=t.url):(i=p.createElement("script"),i.type="text/"+(t.type||"javascript"),i.src=t.url),i.onload=i.onreadystatechange=function(t){t=t||e.event;if("load"===t.type||/loaded|complete/.test(i.readyState)&&(!p.documentMode||9>p.documentMode))i.onload=i.onreadystatechange=i.onerror=null,r()},i.onerror=function(){i.onload=i.onreadystatechange=i.onerror=null,r()},i.async=!1,i.defer=!1;var s=p.head||p.getElementsByTagName("head")[0];s.insertBefore(i,s.lastChild)}function c(){p.body?w||(w=!0,r(d,function(e){o(e)})):(e.clearTimeout(S.readyTimeout),S.readyTimeout=e.setTimeout(c,50))}function h(){p.addEventListener?(p.removeEventListener("DOMContentLoaded",h,!1),c()):"complete"===p.readyState&&(p.detachEvent("onreadystatechange",h),c())}var p=e.document,d=[],v=[],m={},g={},y="async"in p.createElement("script")||"MozAppearance"in p.documentElement.style||e.opera,b,w,E=e.head_conf&&e.head_conf.head||"head",S=e[E]=e[E]||function(){S.ready.apply(null,arguments)},x=1,T=3,N=4;S.load=y?function(){var e=arguments,t=e[e.length-1],n={};return s(t)||(t=null),r(e,function(r,i){r!==t&&(r=u(r),n[r.name]=r,f(r,t&&i===e.length-2?function(){a(n)&&o(t)}:null))}),S}:function(){var e=arguments,n=[].slice.call(e,1),i=n[0];return b?(i?(r(n,function(e){if(!s(e)){var n=u(e);n.state===t&&(n.state=x,n.onpreload=[],l({url:n.url,type:"cache"},function(){n.state=2,r(n.onpreload,function(e){e.call()})}))}}),f(u(e[0]),s(i)?i:function(){S.load.apply(null,n)})):f(u(e[0])),S):(v.push(function(){S.load.apply(null,e)}),S)},S.js=S.load,S.test=function(e,t,r,s){return e="object"==typeof e?e:{test:e,success:t?i("Array",t)?t:[t]:!1,failure:r?i("Array",r)?r:[r]:!1,callback:s||n},(t=!!e.test)&&e.success?(e.success.push(e.callback),S.load.apply(null,e.success)):!t&&e.failure?(e.failure.push(e.callback),S.load.apply(null,e.failure)):s(),S},S.ready=function(e,t){if(e===p)return w?o(t):d.push(t),S;s(e)&&(t=e,e="ALL");if("string"!=typeof e||!s(t))return S;var n=g[e];return n&&n.state===N||"ALL"===e&&a()&&w?(o(t),S):((n=m[e])?n.push(t):m[e]=[t],S)},S.ready(p,function(){a()&&r(m.ALL,function(e){o(e)}),S.feature&&S.feature("domloaded",!0)});if("complete"===p.readyState)c();else if(p.addEventListener)p.addEventListener("DOMContentLoaded",h,!1),e.addEventListener("load",c,!1);else{p.attachEvent("onreadystatechange",h),e.attachEvent("onload",c);var C=!1;try{C=null==e.frameElement&&p.documentElement}catch(k){}C&&C.doScroll&&function L(){if(!w){try{C.doScroll("left")}catch(t){e.clearTimeout(S.readyTimeout),S.readyTimeout=e.setTimeout(L,50);return}c()}}()}setTimeout(function(){b=!0,r(v,function(e){e()})},300)})(window);var swfobject=function(){function C(){if(b)return;try{var e=a.getElementsByTagName("body")[0].appendChild(U("span"));e.parentNode.removeChild(e)}catch(t){return}b=!0;var n=c.length;for(var r=0;r<n;r++)c[r]()}function k(e){b?e():c[c.length]=e}function L(t){if(typeof u.addEventListener!=e)u.addEventListener("load",t,!1);else if(typeof a.addEventListener!=e)a.addEventListener("load",t,!1);else if(typeof u.attachEvent!=e)z(u,"onload",t);else if(typeof u.onload=="function"){var n=u.onload;u.onload=function(){n(),t()}}else u.onload=t}function A(){l?O():M()}function O(){var n=a.getElementsByTagName("body")[0],r=U(t);r.setAttribute("type",i);var s=n.appendChild(r);if(s){var o=0;(function(){if(typeof s.GetVariable!=e){var t=s.GetVariable("$version");t&&(t=t.split(" ")[1].split(","),T.pv=[parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10)])}else if(o<10){o++,setTimeout(arguments.callee,10);return}n.removeChild(r),s=null,M()})()}else M()}function M(){var t=h.length;if(t>0)for(var n=0;n<t;n++){var r=h[n].id,i=h[n].callbackFn,s={success:!1,id:r};if(T.pv[0]>0){var o=R(r);if(o)if(W(h[n].swfVersion)&&!(T.wk&&T.wk<312))V(r,!0),i&&(s.success=!0,s.ref=_(r),i(s));else if(h[n].expressInstall&&D()){var u={};u.data=h[n].expressInstall,u.width=o.getAttribute("width")||"0",u.height=o.getAttribute("height")||"0",o.getAttribute("class")&&(u.styleclass=o.getAttribute("class")),o.getAttribute("align")&&(u.align=o.getAttribute("align"));var a={},f=o.getElementsByTagName("param"),l=f.length;for(var c=0;c<l;c++)f[c].getAttribute("name").toLowerCase()!="movie"&&(a[f[c].getAttribute("name")]=f[c].getAttribute("value"));P(u,a,r,i)}else H(o),i&&i(s)}else{V(r,!0);if(i){var p=_(r);p&&typeof p.SetVariable!=e&&(s.success=!0,s.ref=p),i(s)}}}}function _(n){var r=null,i=R(n);if(i&&i.nodeName=="OBJECT")if(typeof i.SetVariable!=e)r=i;else{var s=i.getElementsByTagName(t)[0];s&&(r=s)}return r}function D(){return!w&&W("6.0.65")&&(T.win||T.mac)&&!(T.wk&&T.wk<312)}function P(t,n,r,i){w=!0,g=i||null,y={success:!1,id:r};var o=R(r);if(o){o.nodeName=="OBJECT"?(v=B(o),m=null):(v=o,m=r),t.id=s;if(typeof t.width==e||!/%$/.test(t.width)&&parseInt(t.width,10)<310)t.width="310";if(typeof t.height==e||!/%$/.test(t.height)&&parseInt(t.height,10)<137)t.height="137";a.title=a.title.slice(0,47)+" - Flash Player Installation";var f=T.ie&&T.win?"ActiveX":"PlugIn",l="MMredirectURL="+u.location.toString().replace(/&/g,"%26")+"&MMplayerType="+f+"&MMdoctitle="+a.title;typeof n.flashvars!=e?n.flashvars+="&"+l:n.flashvars=l;if(T.ie&&T.win&&o.readyState!=4){var c=U("div");r+="SWFObjectNew",c.setAttribute("id",r),o.parentNode.insertBefore(c,o),o.style.display="none",function(){o.readyState==4?o.parentNode.removeChild(o):setTimeout(arguments.callee,10)}()}j(t,n,r)}}function H(e){if(T.ie&&T.win&&e.readyState!=4){var t=U("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(B(e),t),e.style.display="none",function(){e.readyState==4?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(B(e),e)}function B(e){var n=U("div");if(T.win&&T.ie)n.innerHTML=e.innerHTML;else{var r=e.getElementsByTagName(t)[0];if(r){var i=r.childNodes;if(i){var s=i.length;for(var o=0;o<s;o++)(i[o].nodeType!=1||i[o].nodeName!="PARAM")&&i[o].nodeType!=8&&n.appendChild(i[o].cloneNode(!0))}}}return n}function j(n,r,s){var o,u=R(s);if(T.wk&&T.wk<312)return o;if(u){typeof n.id==e&&(n.id=s);if(T.ie&&T.win){var a="";for(var f in n)n[f]!=Object.prototype[f]&&(f.toLowerCase()=="data"?r.movie=n[f]:f.toLowerCase()=="styleclass"?a+=' class="'+n[f]+'"':f.toLowerCase()!="classid"&&(a+=" "+f+'="'+n[f]+'"'));var l="";for(var c in r)r[c]!=Object.prototype[c]&&(l+='<param name="'+c+'" value="'+r[c]+'" />');u.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+a+">"+l+"</object>",p[p.length]=n.id,o=R(n.id)}else{var h=U(t);h.setAttribute("type",i);for(var d in n)n[d]!=Object.prototype[d]&&(d.toLowerCase()=="styleclass"?h.setAttribute("class",n[d]):d.toLowerCase()!="classid"&&h.setAttribute(d,n[d]));for(var v in r)r[v]!=Object.prototype[v]&&v.toLowerCase()!="movie"&&F(h,v,r[v]);u.parentNode.replaceChild(h,u),o=h}}return o}function F(e,t,n){var r=U("param");r.setAttribute("name",t),r.setAttribute("value",n),e.appendChild(r)}function I(e){var t=R(e);t&&t.nodeName=="OBJECT"&&(T.ie&&T.win?(t.style.display="none",function(){t.readyState==4?q(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function q(e){var t=R(e);if(t){for(var n in t)typeof t[n]=="function"&&(t[n]=null);t.parentNode.removeChild(t)}}function R(e){var t=null;try{t=a.getElementById(e)}catch(n){}return t}function U(e){return a.createElement(e)}function z(e,t,n){e.attachEvent(t,n),d[d.length]=[e,t,n]}function W(e){var t=T.pv,n=e.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?!0:!1}function X(n,r,i,s){if(T.ie&&T.mac)return;var o=a.getElementsByTagName("head")[0];if(!o)return;var u=i&&typeof i=="string"?i:"screen";s&&(E=null,S=null);if(!E||S!=u){var f=U("style");f.setAttribute("type","text/css"),f.setAttribute("media",u),E=o.appendChild(f),T.ie&&T.win&&typeof a.styleSheets!=e&&a.styleSheets.length>0&&(E=a.styleSheets[a.styleSheets.length-1]),S=u}T.ie&&T.win?E&&typeof E.addRule==t&&E.addRule(n,r):E&&typeof a.createTextNode!=e&&E.appendChild(a.createTextNode(n+" {"+r+"}"))}function V(e,t){if(!x)return;var n=t?"visible":"hidden";b&&R(e)?R(e).style.visibility=n:X("#"+e,"visibility:"+n)}function $(t){var n=/[\\\"<>\.;]/,r=n.exec(t)!=null;return r&&typeof encodeURIComponent!=e?encodeURIComponent(t):t}var e="undefined",t="object",n="Shockwave Flash",r="ShockwaveFlash.ShockwaveFlash",i="application/x-shockwave-flash",s="SWFObjectExprInst",o="onreadystatechange",u=window,a=document,f=navigator,l=!1,c=[A],h=[],p=[],d=[],v,m,g,y,b=!1,w=!1,E,S,x=!0,T=function(){var s=typeof a.getElementById!=e&&typeof a.getElementsByTagName!=e&&typeof a.createElement!=e,o=f.userAgent.toLowerCase(),c=f.platform.toLowerCase(),h=c?/win/.test(c):/win/.test(o),p=c?/mac/.test(c):/mac/.test(o),d=/webkit/.test(o)?parseFloat(o.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,v=!1,m=[0,0,0],g=null;if(typeof f.plugins!=e&&typeof f.plugins[n]==t)g=f.plugins[n].description,g&&(typeof f.mimeTypes==e||!f.mimeTypes[i]||!!f.mimeTypes[i].enabledPlugin)&&(l=!0,v=!1,g=g.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),m[0]=parseInt(g.replace(/^(.*)\..*$/,"$1"),10),m[1]=parseInt(g.replace(/^.*\.(.*)\s.*$/,"$1"),10),m[2]=/[a-zA-Z]/.test(g)?parseInt(g.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof u.ActiveXObject!=e)try{var y=new ActiveXObject(r);y&&(g=y.GetVariable("$version"),g&&(v=!0,g=g.split(" ")[1].split(","),m=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)]))}catch(b){}return{w3:s,pv:m,wk:d,ie:v,win:h,mac:p}}(),N=function(){if(!T.w3)return;(typeof a.readyState!=e&&a.readyState=="complete"||typeof a.readyState==e&&(a.getElementsByTagName("body")[0]||a.body))&&C(),b||(typeof a.addEventListener!=e&&a.addEventListener("DOMContentLoaded",C,!1),T.ie&&T.win&&(a.attachEvent(o,function(){a.readyState=="complete"&&(a.detachEvent(o,arguments.callee),C())}),u==top&&function(){if(b)return;try{a.documentElement.doScroll("left")}catch(e){setTimeout(arguments.callee,0);return}C()}()),T.wk&&function(){if(b)return;if(!/loaded|complete/.test(a.readyState)){setTimeout(arguments.callee,0);return}C()}(),L(C))}(),J=function(){T.ie&&T.win&&window.attachEvent("onunload",function(){var e=d.length;for(var t=0;t<e;t++)d[t][0].detachEvent(d[t][1],d[t][2]);var n=p.length;for(var r=0;r<n;r++)I(p[r]);for(var i in T)T[i]=null;T=null;for(var s in swfobject)swfobject[s]=null;swfobject=null})}();return{registerObject:function(e,t,n,r){if(T.w3&&e&&t){var i={};i.id=e,i.swfVersion=t,i.expressInstall=n,i.callbackFn=r,h[h.length]=i,V(e,!1)}else r&&r({success:!1,id:e})},getObjectById:function(e){if(T.w3)return _(e)},embedSWF:function(n,r,i,s,o,u,a,f,l,c){var h={success:!1,id:r};T.w3&&!(T.wk&&T.wk<312)&&n&&r&&i&&s&&o?(V(r,!1),k(function(){i+="",s+="";var p={};if(l&&typeof l===t)for(var d in l)p[d]=l[d];p.data=n,p.width=i,p.height=s;var v={};if(f&&typeof f===t)for(var m in f)v[m]=f[m];if(a&&typeof a===t)for(var g in a)typeof v.flashvars!=e?v.flashvars+="&"+g+"="+a[g]:v.flashvars=g+"="+a[g];if(W(o)){var y=j(p,v,r);p.id==r&&V(r,!0),h.success=!0,h.ref=y}else{if(u&&D()){p.data=u,P(p,v,r,c);return}V(r,!0)}c&&c(h)})):c&&c(h)},switchOffAutoHideShow:function(){x=!1},ua:T,getFlashPlayerVersion:function(){return{major:T.pv[0],minor:T.pv[1],release:T.pv[2]}},hasFlashPlayerVersion:W,createSWF:function(e,t,n){return T.w3?j(e,t,n):undefined},showExpressInstall:function(e,t,n,r){T.w3&&D()&&P(e,t,n,r)},removeSWF:function(e){T.w3&&I(e)},createCSS:function(e,t,n,r){T.w3&&X(e,t,n,r)},addDomLoadEvent:k,addLoadEvent:L,getQueryParamValue:function(e){var t=a.location.search||a.location.hash;if(t){/\?/.test(t)&&(t=t.split("?")[1]);if(e==null)return $(t);var n=t.split("&");for(var r=0;r<n.length;r++)if(n[r].substring(0,n[r].indexOf("="))==e)return $(n[r].substring(n[r].indexOf("=")+1))}return""},expressInstallCallback:function(){if(w){var e=R(s);e&&v&&(e.parentNode.replaceChild(v,e),m&&(V(m,!0),T.ie&&T.win&&(v.style.display="block")),g&&g(y)),w=!1}}}}();(function(e){spell_setDimensions=function(t,n,r){var i=e.getElementById(t);i.style.width=n+"px",i.style.height=r+"px"}})(document),window.console||(window.console={log:function(){}}),function(e){var t="10.1.0",n="spell",r={DEPLOYED:"deployed",DEVELOPMENT_EMBEDDED:"development_embedded",DEVELOPMENT_STANDALONE:"development_standalone"},i=function(){var e=window.location.href,t={};return e.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,n,r){t[n]=r}),t},s=function(e){var t=i();for(var n in t){var r=t[n];e[n]=r==="false"||r==="true"?r==="true":r}},o=function(t){return t?!!e.getElementById(t):!!e.getElementById(n)},u=function(){var t=e.createElement("audio"),n=!!t.canPlayType;if(!n)return!1;var r=['audio/ogg; codecs="vorbis"',"audio/mpeg"];if(g())return!1;for(var i=0;i<r.length;i++)try{if(""!=t.canPlayType(r[i]).replace(/^no$/,""))return!0}catch(s){}return!1},a=function(){if(!window.webkitAudioContext)return!1;try{var e=new webkitAudioContext;return!0}catch(t){return!1}},f=function(){var e=l("Chrome",22)||l("Firefox",18)||l("Safari",6)||l("IE",10)||!c();return!e},l=function(e,t){var n=e==="Safari"?navigator.userAgent.match(/.*Version\/(\d+).*Safari/):e==="IE"?navigator.userAgent.match(/.*MSIE (\d+)/):navigator.userAgent.match(new RegExp(".*"+e+"\\/(\\d+)"));if(!n)return!1;var r=parseInt(n[1],10);return r<t},c=function(){var t=e.createElement("canvas");return t.getContext&&t.getContext("2d")},h=function(){var t,n=["webgl","experimental-webgl","webkit-3d","moz-webgl"],r={alpha:!1},i=!1,s=e.createElement("canvas");for(var o=0;o<n.length;o++){try{t=s.getContext(n[o],r)}catch(u){}if(t){i=!0;break}}return delete s,delete t,i},p=function(){return swfobject.hasFlashPlayerVersion(t)},d=function(){var e=navigator.language||navigator.userLanguage||"";return e.split("-").shift().toLowerCase()},v=function(e){e.id||(e.id="spell"),e.target||(f()?e.target="html5":p()&&(e.target="flash")),e.target==="html5"&&(!e.renderingBackEnd&&h()&&(e.renderingBackEnd="webgl"),e.audioBackEnd||(e.audioBackEnd=a()?"web":u()?"html5":"dummy")),e.verbose||(e.verbose=!1),e.mode||(e.mode=r.DEPLOYED),e.currentLanguage||(e.currentLanguage=d())},m=function(e){return e.target==="html5"&&f()?!0:e.target==="flash"&&p()?!0:!1},g=function(){return navigator.userAgent.indexOf("IEMobile/9.0")>-1||navigator.userAgent.indexOf("IEMobile/10.0")>-1},y=function(e,t,n,r){if(!t.target)throw"Error: Invalid config. Property 'target' is not defined.";if(t.target!=="html5"&&t.target!=="flash")throw"Error: Invalid config. Value '"+t.target+"' for property 'target' is not supported.";t.verbose&&console.log("stage-zero-loader: chose "+t.target+" target"),t.target==="html5"?b(t,e,n,r):w(t,t.verbose)},b=function(e,t,n,i){var s=e.mode===r.DEPLOYED,o=!s,u=function(){e.verbose&&x();var r=require("spell/client/main",e);o&&i&&E(t,r,i),s&&r.start(spell.applicationModule,spell.cache),n&&n(r)};e.verbose&&S();var a=["html5/spell.js"];s&&a.push("html5/data.js"),a.push(u),head.js.apply(null,a)},w=function(e,n){n&&S();var r=T(e.id,e.id+"-screen"),i=T(r.id,r.id+"-flash");e.libraryUrl="library",swfobject.embedSWF("flash/spell.swf",i.id,"100%","100%",t,"playerProductInstall.swf",e,null,null,function(){n&&x()})},E=function(e,t,n){t.setSendMessageToEditor(n),e.sendDebugMessage=function(e){t.sendDebugMessage(e)}},S=function(){console.log("stage-zero-loader: loading executable")},x=function(){console.log("stage-zero-loader: launching executable")},T=function(t,n){var r=e.getElementById(t),i=e.createElement("div");return i.id=n,r.appendChild(i),i},N=function(){return window.location.protocol!="file:"},C=function(t,n){e.getElementById(t).innerHTML='<p style="color: #FFFFFF">'+n+"</p>"};window.spell={start:function(e,t,n){e||(e={}),s(e),v(e);if(!o(e.id))throw'Could not find dom node with id "'+e.id+'". Please provide a valid id.';if(e.mode==r.DEPLOYED&&!N())throw'Protocol "file:" is not supported. Please use "http:" instead.';if(!m(e)){C(e.id,"Your browser does not meet the minimum requirements to run SpellJS.");return}y(this,e,t,n)},addToCache:function(e){this.cache=e},setApplicationModule:function(e){this.applicationModule=e}}}(document)
